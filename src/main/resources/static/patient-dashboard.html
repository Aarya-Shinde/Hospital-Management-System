<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Patient Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<h2>My Appointments</h2>

<label for="patientName">Enter Your Name:</label>
<input type="text" id="patientName">
<button onclick="loadPatientAppointments()">View My Appointments</button>

<table>
  <thead>
  <tr><th>Doctor</th><th>Date</th><th>Time</th><th>Status</th><th>Action</th></tr>
  </thead>
  <tbody id="patientAppointments"></tbody>
</table>

<script>
  function loadPatientAppointments() {
      const patientName = document.getElementById("patientName").value;

      axios.get("http://localhost:8080/appointments/all")
          .then(response => {
              let rows = "";
              response.data.forEach(app => {
                  if (app.patientName === patientName) {
                      rows += `<tr><td>${app.doctorName}</td><td>${app.date}</td><td>${app.time}</td><td>${app.status}</td>
                               <td><button onclick="cancelAppointment(${app.id})">Cancel</button></td></tr>`;
                  }
              });
              document.getElementById("patientAppointments").innerHTML = rows;
          });
  }

  function cancelAppointment(id) {
      axios.delete(`http://localhost:8080/appointments/cancel/${id}`)
          .then(() => alert("Appointment canceled"));
  }
</script>
</body>
</html>
